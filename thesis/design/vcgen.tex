\subsection{VCGen with WP}
\label{subsec:vcgen_wp}

The rules for WP computation are defined by


\[
  \mathrm{WP}(\mathcal{P}, idx, Q) =
  \begin{cases}
    \mathrm{true}, & \mathcal{P}_{idx} = \mathrm{exit} \\
    \forall v . v = p \implies \mathrm{WP}(\mathcal{P}, idx+1, Q)[x \leftarrow v])) , & \mathcal{P}_{idx} = x := p \\    
    \forall v . v = p_1 \oplus p_2 \implies \mathrm{WP}(\mathcal{P}, idx+1, Q)[x \leftarrow v])) , & \mathcal{P}_{idx} = x := p_1 \oplus p_2 \\
    \forall v . v = p_1 \otimes p_2 \implies \mathrm{WP}(\mathcal{P}, idx+1, Q)[x \leftarrow v])) , & \mathcal{P}_{idx} = x := p_1 \otimes p_2 \\    
    \forall v . (p_2  \neq 0 \land (v = p_1 \oslash p_2 \implies \mathrm{WP}(\mathcal{P}, idx+1, Q)[x \leftarrow v])) , & \mathcal{P}_{idx} = x := p_1 \oslash p_2 \\
    \forall v . v = p_1 ~ \mathrm{xor} ~ p_2 \implies \mathrm{WP}(\mathcal{P}, idx+1, Q)[x \leftarrow v])) , & \mathcal{P}_{idx} = x := p_1 ~ \mathrm{xor} ~ p_2 \\
    \mathrm{if} ~ p = e ~ \mathrm{then} ~ WP(\mathcal{P}, idx+1+off, Q) ~ \mathrm{else} ~ WP(\mathcal{P},idx+1, Q) , & \mathcal{P}_{idx} = \mathrm{if} ~ p = e ~ \mathrm{then} ~ \mathrm{off} \\
    \mathrm{if} ~ p \neq e ~ \mathrm{then} ~ WP(\mathcal{P}, idx+1+off, Q) ~ \mathrm{else} ~ WP(\mathcal{P},idx+1, Q) , & \mathcal{P}_{idx} = \mathrm{if} ~ p \neq e ~ \mathrm{then} ~ \mathrm{off} \\    
    \mathrm{if} ~ p \geq e ~ \mathrm{then} ~ WP(\mathcal{P}, idx+1+off, Q) ~ \mathrm{else} ~ WP(\mathcal{P},idx+1, Q) , & \mathcal{P}_{idx} = \mathrm{if} ~ p \geq e ~ \mathrm{then} ~ \mathrm{off} \\    \end{cases}
\]


